# Отчет о реализации проекта
## Использованные технологии
### Операционная система: 
#### Linux (Ubuntu)

### Язык программирования: 
#### Golang

### Библиотеки:

#### Стандартная библиотека: 
Использовалась для работы с базой данных, управления контекстом и обработки HTTP-запросов.
#### Сторонние библиотеки:
##### github.com/lib/pq: 
Драйвер для PostgreSQL.
##### gopkg.in/yaml.v2: 
Для парсинга YAML.

### База данных: 
#### PostgreSQL

## Трудности и их решения
### Управление конфигурацией:

#### Проблема: 
##### Нужно было организовать удобное управление конфигурацией, особенно для настроек базы данных и сервера.
#### Решение: 
##### Вынес все настройки в файл config/config.yaml, а загрузку конфигурации реализовал в config/config.go. Это позволило легко изменять параметры без правки кода.

### Подключение к базе данных:

#### Проблема: 
##### Обеспечить стабильное подключение к PostgreSQL и обработку ошибок подключения.
#### Решение: 
##### Создал функцию InitDB в internal/db/db.go, которая инициализирует подключение с использованием параметров из конфигурации. Также добавил проверку доступности базы данных с помощью DB.Ping().

### Параллельное выполнение команд:

#### Проблема: 
##### Необходимо было управлять параллельным выполнением команд и избегать гонок данных.
#### Решение: 
##### Использовал sync.Mutex для синхронизации доступа к карте commandExecutions, которая отслеживает выполняемые команды. Это предотвратило гонки данных и обеспечило потокобезопасность.

### Обработка длительных процессов:

#### Проблема: 
##### Правильное управление командами, которые могут выполняться долгое время, и обновление их статуса.
#### Решение: 
##### Использовал пакет context для создания контекста с тайм-аутом для каждой команды. Это позволило корректно завершать команды, которые выполняются слишком долго, и обновлять их статус в базе данных.

### Корректное завершение команд:

#### Проблема: 
##### Нужно было реализовать возможность остановки выполняющихся команд по запросу пользователя.
#### Решение: 
##### Добавил функцию StopCommand, которая завершает процесс команды с помощью execCmd.Process.Kill() и обновляет статус команды в базе данных.

### Обработка ошибок и логирование:

#### Проблема: 
##### Обеспечить всестороннюю обработку ошибок и логирование для упрощения отладки.
#### Решение: 
##### Включил обработку ошибок в критических местах кода, особенно при работе с базой данных и выполнении команд. Использовал пакет log для последовательного логирования ошибок и важных событий.

# Записка в формате ADR
## Контекст:
### Для разработки приложения на языке Golang с использованием базы данных PostgreSQL и развертыванием на операционной системе Linux (Ubuntu), необходимо было обеспечить корректное выполнение команд оболочки и управление их статусами через REST API.

## Решение:

### Операционная система: 
#### Выбран дистрибутив Ubuntu за его популярность и поддержку различных инструментов разработки.
### Язык программирования: 
#### Golang выбран из-за его производительности, простоты и встроенной поддержки параллелизма.
### Библиотеки:
#### Стандартная библиотека: 
##### Использовалась для обработки HTTP-запросов, работы с контекстом и базой данных.
#### Сторонние библиотеки: 
##### github.com/lib/pq для работы с PostgreSQL
##### gopkg.in/yaml.v2 для парсинга YAML конфигураций.
#### База данных: 
##### PostgreSQL выбрана за её мощные возможности и широкую поддержку.

### Трудности и решения:

#### Управление конфигурацией с использованием YAML-файлов и стандартной библиотеки yaml.
#### Надежное подключение к базе данных и обработка ошибок с использованием стандартной библиотеки database/sql.
#### Параллельное выполнение команд и предотвращение гонок данных с использованием пакета sync.
#### Управление долго выполняющимися процессами с помощью контекста и тайм-аутов.
#### Реализация механизма для остановки выполняющихся команд и обновление их статуса в базе данных.
#### Всеобъемлющая обработка ошибок и логирование для упрощения отладки и обслуживания приложения.
#### Таким образом, обеспечил высокую надежность и масштабируемость приложения при минимальном использовании сторонних библиотек.






